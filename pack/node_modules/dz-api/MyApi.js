const axios = require('axios');

class Api {
  constructor(apiUrl, token, secret) {
    this.apiUrl = apiUrl;
    this.token = token;
    this.secret = secret;
  }

  // Helper method to set common headers
  setHeaders() {
    return {
      Token: this.token,
      Secret: this.secret,
    };
  }

  // Handle HTTP request errors consistently
  handleRequestError(error) {
    console.error("API request failed:", error);
    throw error;
  }

  async checkToken() {
    try {
      const response = await axios.get(`${this.apiUrl}/users`, {
        headers: this.setHeaders(),
      });

      // Return only the response data
      return response.data;
    } catch (error) {
      this.handleRequestError(error);
    }
  }
}

module.exports = Api;
